<h1>Detalle Proyecto</h1>

<div class="card border rounded p-4 shadow-sm">
  <div class="card-body">
    <h5 class="card-title">
      <i class="bi bi-kanban"></i> {{ proyecto?.name }}
    </h5>
    <p><strong>Descripci칩n:</strong> {{ proyecto?.description }}</p>

    <p>
      <strong>Estado:</strong>
      <span class="badge"
            [ngClass]="{
              'bg-success': estadoProyecto === 'ok',
              'bg-warning': estadoProyecto === 'pendiente',
              'bg-danger': estadoProyecto === 'error'
            }">
        {{ estadoProyecto | uppercase }}
      </span>
    </p>

    <hr>

    <p><strong>Usuario:</strong> {{ usuarioNombre }}</p>
    <p><strong>Creado:</strong> {{ proyecto?.created_at | date:'short' }}</p>
    <p><strong>Actualizado:</strong> {{ proyecto?.updated_at | date:'short' }}</p>
    <!-- <p><strong>Fecha entrega:</strong> {{ proyecto?.fecha_entrega | date:'longDate' }}</p> -->
  </div>

  <!-- Acciones -->
  <div class="d-flex justify-content-evenly mt-3">
    <button class="btn btn-primary" (click)="editarProyecto()">
      <i class="bi bi-pencil"></i> Editar
    </button>
    <button class="btn btn-danger" (click)="eliminarProyecto()">
      <i class="bi bi-trash"></i> Eliminar
    </button>
  </div>
</div>

<!-- Secci칩n resumen -->
<div class="row mt-4">
  <div class="col-md-6">
    <div class="card shadow-sm">
      <div class="card-header bg-light">
        <i class="bi bi-box-seam"></i> Versiones
      </div>
      <ul class="list-group list-group-flush">
        <li class="list-group-item" *ngFor="let v of (mostrarTodasVersiones ? versiones : versiones.slice(0,3))">
          <strong>{{ v.numero_version }}</strong>
          <span class="text-muted">({{ v.fecha_lanzamiento | date:'shortDate' }})</span>
          <p class="mb-0">{{ v.descripcion }}</p>
        </li>
      </ul>
      @if(versiones.length > 3) {
      <button class="btn btn-link" (click)="mostrarTodasVersiones = !mostrarTodasVersiones">
        <i class="bi" [ngClass]="mostrarTodasVersiones ? 'bi-chevron-up' : 'bi-chevron-down'"></i>
        {{ mostrarTodasVersiones ? 'Ver menos' : 'Ver m치s' }}
      </button>
      }
    </div>
  </div>

  <div class="col-md-6">
    <div class="card shadow-sm">
      <div class="card-header bg-light">
        <i class="bi bi-check2-circle"></i> Pruebas
      </div>
      <ul class="list-group list-group-flush">
        <li class="list-group-item" *ngFor="let pr of (mostrarTodasPruebas ? pruebas : pruebas.slice(0,3))">
          <strong>{{ pr.titulo }}</strong>
          <span class="badge bg-secondary ms-2">{{ pr.rol }}</span>
          <p class="mb-0"><em>{{ pr.objetivo }}</em></p>
          <small class="text-muted">Resultado esperado: {{ pr.resultado_esperado }}</small>
        </li>
      </ul>
      
      @if(pruebas.length > 3) {
      <button class="btn btn-link" (click)="mostrarTodasPruebas = !mostrarTodasPruebas">
        <i class="bi" [ngClass]="mostrarTodasPruebas ? 'bi-chevron-up' : 'bi-chevron-down'"></i>
        {{ mostrarTodasPruebas ? 'Ver menos' : 'Ver m치s' }}
      </button>
      }
    </div>
  </div>
</div>